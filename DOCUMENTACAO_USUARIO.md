# üìö DOCUMENTA√á√ÉO COMPLETA DO SISTEMA DE RECOMENDA√á√ïES DE OFERTAS TELEGRAM

## üéØ **VIS√ÉO GERAL**

O **Sistema de Recomenda√ß√µes de Ofertas Telegram** √© um bot inteligente que monitora m√∫ltiplas plataformas de e-commerce, identifica ofertas e promo√ß√µes em tempo real, e recomenda produtos personalizados baseado nas prefer√™ncias dos usu√°rios.

## üöÄ **FUNCIONALIDADES PRINCIPAIS**

### **1. Sistema de Cache Inteligente**
- **Cache em Mem√≥ria**: Reduz requisi√ß√µes repetidas
- **Persist√™ncia em Disco**: Mant√©m dados entre reinicializa√ß√µes
- **TTL Configur√°vel**: Tempo de vida personaliz√°vel para diferentes tipos de dados
- **Limpeza Autom√°tica**: Remove dados expirados automaticamente

### **2. Rate Limiting Inteligente**
- **M√∫ltiplas Estrat√©gias**: Janela fixa, deslizante, adaptativa
- **Limites por Dom√≠nio**: Configura√ß√µes espec√≠ficas para cada loja
- **Detec√ß√£o de Bloqueios**: Identifica e responde a bloqueios automaticamente
- **Backoff Exponencial**: Ajusta automaticamente a frequ√™ncia de requisi√ß√µes

### **3. Monitoramento de Sa√∫de**
- **Verifica√ß√µes em Tempo Real**: Monitora sa√∫de de todos os servi√ßos
- **Alertas Autom√°ticos**: Notifica sobre problemas detectados
- **M√©tricas de Performance**: Coleta dados de resposta e disponibilidade
- **Hist√≥rico de Problemas**: Mant√©m registro de incidentes

### **4. M√©tricas de Performance**
- **Coleta em Tempo Real**: Monitora performance do sistema
- **Detec√ß√£o de Anomalias**: Identifica problemas automaticamente
- **Dashboard de M√©tricas**: Visualiza√ß√£o em tempo real
- **Persist√™ncia de Dados**: Armazena hist√≥rico para an√°lise

### **5. Sistema de Categorias de Usu√°rios**
- **Prefer√™ncias Personalizadas**: Usu√°rios definem categorias de interesse
- **Notifica√ß√µes Inteligentes**: Alerta apenas sobre ofertas relevantes
- **Hist√≥rico de Prefer√™ncias**: Rastreia mudan√ßas ao longo do tempo
- **Recomenda√ß√µes Baseadas em Comportamento**: Sugere categorias similares

### **6. Hist√≥rico de Pre√ßos**
- **Rastreamento de Pre√ßos**: Monitora mudan√ßas de pre√ßo ao longo do tempo
- **An√°lise de Tend√™ncias**: Identifica padr√µes e sazonalidade
- **Alertas de Pre√ßo**: Notifica sobre mudan√ßas significativas
- **Estat√≠sticas Avan√ßadas**: M√©dia, mediana, desvio padr√£o, volatilidade

### **7. Comparador de Pre√ßos**
- **Compara√ß√£o Entre Lojas**: Encontra o melhor pre√ßo dispon√≠vel
- **Algoritmo de Similaridade**: Identifica produtos similares
- **Recomenda√ß√µes Inteligentes**: Sugere alternativas baseadas em pre√ßo
- **Hist√≥rico de Compara√ß√µes**: Mant√©m registro de an√°lises

### **8. Sistema de Reviews**
- **Avalia√ß√µes de Produtos**: Usu√°rios podem avaliar produtos
- **Modera√ß√£o de Conte√∫do**: Sistema de aprova√ß√£o para reviews
- **M√©tricas de Produto**: Rating m√©dio, distribui√ß√£o de notas
- **Hist√≥rico de Reviews**: Rastreia mudan√ßas e a√ß√µes de modera√ß√£o

## üë• **COMANDOS DISPON√çVEIS**

### **Comandos para Todos os Usu√°rios**

#### **`/start`** - Iniciar o Bot
```
Inicia o bot e exibe mensagem de boas-vindas com instru√ß√µes b√°sicas
```

#### **`/notificacoes`** - Configurar Notifica√ß√µes
```
Configura prefer√™ncias de notifica√ß√£o:
- Categorias de interesse
- Faixa de pre√ßo
- Frequ√™ncia de notifica√ß√µes
- Lojas preferidas
```

#### **`/favoritos`** - Gerenciar Lojas Favoritas
```
Gerencia lojas favoritas para receber notifica√ß√µes priorit√°rias
```

#### **`/categorias`** - Configurar Categorias
```
Define categorias de produtos de interesse:
- Eletr√¥nicos
- Inform√°tica
- Casa e Jardim
- Moda
- Esportes
- etc.
```

#### **`/historico_preco`** - Ver Hist√≥rico de Pre√ßos
```
Visualiza hist√≥rico de pre√ßos de um produto espec√≠fico:
- Gr√°fico de evolu√ß√£o
- Estat√≠sticas de pre√ßo
- Tend√™ncias identificadas
```

#### **`/comparar_preco`** - Comparar Pre√ßos
```
Compara pre√ßos de um produto entre diferentes lojas:
- Melhor pre√ßo dispon√≠vel
- Alternativas similares
- Recomenda√ß√µes de compra
```

#### **`/review`** - Adicionar Review
```
Adiciona avalia√ß√£o a um produto:
- Nota de 1 a 5 estrelas
- Coment√°rio detalhado
- Categorias de avalia√ß√£o
```

#### **`/reviews`** - Ver Reviews de Produto
```
Visualiza todas as avalia√ß√µes de um produto espec√≠fico:
- Rating m√©dio
- Distribui√ß√£o de notas
- Coment√°rios dos usu√°rios
```

#### **`/minhas_reviews`** - Ver Suas Reviews
```
Lista todas as suas avalia√ß√µes:
- Produtos avaliados
- Notas dadas
- Status das reviews
```

### **Comandos Apenas para Administradores**

#### **`/buscar`** - For√ßar Busca por Ofertas
```
Executa busca manual por ofertas em todas as plataformas
```

#### **`/oferta`** - Publicar Oferta Manualmente
```
Publica oferta espec√≠fica no canal do Telegram
```

#### **`/status`** - Status do Sistema
```
Exibe status geral do sistema:
- Sa√∫de dos servi√ßos
- Performance atual
- Problemas detectados
```

#### **`/metrics`** - M√©tricas de Performance
```
Mostra m√©tricas detalhadas:
- Cache hit rate
- Tempo de resposta
- Uso de recursos
- Anomalias detectadas
```

#### **`/cache`** - Gerenciar Cache
```
Gerencia sistema de cache:
- Estat√≠sticas de uso
- Limpeza manual
- Configura√ß√µes
```

#### **`/health`** - Sa√∫de dos Servi√ßos
```
Monitora sa√∫de de todos os servi√ßos:
- Status de cada componente
- Problemas detectados
- Recomenda√ß√µes
```

#### **`/moderar_review`** - Moderar Reviews
```
Modera reviews pendentes:
- Aprovar reviews
- Rejeitar conte√∫do inadequado
- Marcar como spam
```

## ‚öôÔ∏è **CONFIGURA√á√ÉO DO SISTEMA**

### **Vari√°veis de Ambiente Necess√°rias**

```bash
# Telegram Bot
TELEGRAM_BOT_TOKEN=seu_token_aqui
TELEGRAM_CHAT_ID=id_do_canal

# Amazon PA-API (Opcional)
AMAZON_ACCESS_KEY=sua_access_key
AMAZON_SECRET_KEY=sua_secret_key
AMAZON_PARTNER_TAG=seu_partner_tag
AMAZON_REGION=us-east-1

# AliExpress API (Opcional)
ALIEXPRESS_APP_KEY=sua_app_key
ALIEXPRESS_APP_SECRET=sua_app_secret

# Awin API (Opcional)
AWIN_API_TOKEN=seu_token_aqui
AWIN_PUBLISHER_ID=seu_publisher_id

# Administradores
ADMIN_USER_IDS=123456,789012
```

### **Arquivos de Configura√ß√£o**

#### **`config_improvements.py`**
Configura√ß√µes centralizadas para todos os sistemas:
- Cache
- Rate Limiting
- Health Monitoring
- Performance Metrics
- Jobs Agendados
- Alertas

#### **`config.py`**
Configura√ß√µes b√°sicas do sistema:
- Credenciais das APIs
- Configura√ß√µes do banco de dados
- Configura√ß√µes do Telegram

## üóÑÔ∏è **BANCOS DE DADOS**

### **Estrutura dos Bancos**

#### **1. `cache.db`** - Sistema de Cache
- Dados em cache com TTL
- Estat√≠sticas de uso
- Persist√™ncia em disco

#### **2. `health_monitor.db`** - Monitoramento de Sa√∫de
- Hist√≥rico de verifica√ß√µes
- M√©tricas de servi√ßos
- Alertas e incidentes

#### **3. `performance_metrics.db`** - M√©tricas de Performance
- M√©tricas em tempo real
- Hist√≥rico de performance
- Detec√ß√£o de anomalias

#### **4. `user_categories.db`** - Categorias de Usu√°rios
- Prefer√™ncias dos usu√°rios
- Hist√≥rico de mudan√ßas
- Notifica√ß√µes configuradas

#### **5. `price_history.db`** - Hist√≥rico de Pre√ßos
- Pontos de pre√ßo ao longo do tempo
- An√°lise de tend√™ncias
- Alertas de pre√ßo

#### **6. `price_comparisons.db`** - Compara√ß√µes de Pre√ßo
- Compara√ß√µes entre lojas
- Produtos similares
- Recomenda√ß√µes

#### **7. `product_reviews.db`** - Reviews de Produtos
- Avalia√ß√µes dos usu√°rios
- M√©tricas de produto
- Hist√≥rico de modera√ß√£o

## üîß **MANUTEN√á√ÉO E MONITORAMENTO**

### **Logs do Sistema**

#### **Localiza√ß√£o dos Logs**
```
logs/
‚îú‚îÄ‚îÄ bot_YYYYMMDD.log          # Log principal do bot
‚îú‚îÄ‚îÄ cache_system.log          # Log do sistema de cache
‚îú‚îÄ‚îÄ rate_limiter.log          # Log do rate limiting
‚îú‚îÄ‚îÄ health_monitor.log        # Log do monitoramento
‚îú‚îÄ‚îÄ performance_metrics.log   # Log das m√©tricas
‚îî‚îÄ‚îÄ ...
```

#### **N√≠veis de Log**
- **DEBUG**: Informa√ß√µes detalhadas para desenvolvimento
- **INFO**: Informa√ß√µes gerais sobre opera√ß√µes
- **WARNING**: Avisos sobre situa√ß√µes que merecem aten√ß√£o
- **ERROR**: Erros que n√£o impedem o funcionamento
- **CRITICAL**: Erros cr√≠ticos que afetam o sistema

### **Jobs Agendados**

#### **Jobs Autom√°ticos**
1. **Limpeza de Cache**: A cada 5 minutos
2. **Backup de M√©tricas**: A cada hora
3. **Verifica√ß√£o de Sa√∫de**: A cada 2 minutos
4. **Busca de Ofertas**: A cada 6 horas
5. **Atualiza√ß√£o de IDs Awin**: A cada 2 horas

#### **Configura√ß√£o de Jobs**
```python
# Em config_improvements.py
SCHEDULED_JOBS_CONFIG = {
    'cache_cleanup_interval': 300,      # 5 minutos
    'metrics_backup_interval': 3600,    # 1 hora
    'health_check_interval': 120,       # 2 minutos
    'offer_search_interval': 21600,     # 6 horas
    'awin_update_interval': 7200        # 2 horas
}
```

### **Monitoramento de Recursos**

#### **M√©tricas Coletadas**
- **CPU**: Uso de processador
- **Mem√≥ria**: Uso de RAM
- **Disco**: Espa√ßo dispon√≠vel
- **Rede**: I/O de rede
- **Aplica√ß√£o**: Requisi√ß√µes, tempo de resposta, taxa de sucesso

#### **Alertas Autom√°ticos**
- **Uso de CPU > 80%**: Alerta de alta carga
- **Mem√≥ria > 90%**: Alerta de mem√≥ria baixa
- **Disco > 95%**: Alerta de espa√ßo baixo
- **Tempo de resposta > 5s**: Alerta de performance

## üö® **RESOLU√á√ÉO DE PROBLEMAS**

### **Problemas Comuns**

#### **1. Bot N√£o Responde**
```bash
# Verificar logs
tail -f logs/bot_YYYYMMDD.log

# Verificar status dos servi√ßos
python -c "import main; print('Bot funcionando')"

# Verificar conex√£o com Telegram
python test_telegram_connection.py
```

#### **2. Cache Lento**
```bash
# Verificar estat√≠sticas do cache
python -c "import cache_system; print(cache_system.cache.get_stats())"

# Limpar cache manualmente
python -c "import cache_system; cache_system.cache.clear()"

# Verificar uso de mem√≥ria
python -c "import psutil; print(psutil.virtual_memory())"
```

#### **3. Rate Limiting Bloqueando**
```bash
# Verificar estrat√©gias ativas
python -c "import rate_limiter; limiter = rate_limiter.IntelligentRateLimiter(); print(limiter.strategies.keys())"

# Verificar dom√≠nios bloqueados
python -c "import rate_limiter; limiter = rate_limiter.IntelligentRateLimiter(); print(limiter.blocked_domains)"
```

#### **4. Banco de Dados Travado**
```bash
# Verificar locks
python -c "import sqlite3; conn = sqlite3.connect('user_categories.db'); print(conn.execute('PRAGMA busy_timeout').fetchone())"

# Recriar banco se necess√°rio
rm user_categories.db
python -c "import user_categories; print('Banco recriado')"
```

### **Comandos de Diagn√≥stico**

#### **Teste de Integra√ß√£o**
```bash
python test_quick.py
```

#### **Teste de Performance**
```bash
python performance_validation.py
```

#### **Teste de Cache**
```bash
python -c "
import cache_system
cache_system.cache.set('test', 'value', 60)
print('Cache funcionando:', cache_system.cache.get('test') == 'value')
"
```

## üìä **M√âTRICAS E RELAT√ìRIOS**

### **Dashboard de M√©tricas**

#### **M√©tricas em Tempo Real**
- **Cache Hit Rate**: Taxa de acerto do cache
- **Response Time**: Tempo de resposta m√©dio
- **Error Rate**: Taxa de erros
- **Throughput**: Opera√ß√µes por segundo

#### **M√©tricas Hist√≥ricas**
- **Performance ao Longo do Tempo**: Gr√°ficos de tend√™ncia
- **Uso de Recursos**: CPU, mem√≥ria, disco
- **Anomalias Detectadas**: Problemas identificados automaticamente

### **Relat√≥rios Dispon√≠veis**

#### **1. Relat√≥rio de Sa√∫de**
- Status de todos os servi√ßos
- Problemas detectados
- Recomenda√ß√µes de a√ß√£o

#### **2. Relat√≥rio de Performance**
- M√©tricas de throughput
- Tempos de resposta
- Uso de recursos

#### **3. Relat√≥rio de Cache**
- Hit rate
- Tamanho do cache
- Opera√ß√µes por segundo

#### **4. Relat√≥rio de Rate Limiting**
- Requisi√ß√µes permitidas/bloqueadas
- Estrat√©gias ativas
- Dom√≠nios bloqueados

## üîí **SEGURAN√áA**

### **Controle de Acesso**

#### **Comandos Administrativos**
- Apenas usu√°rios listados em `ADMIN_USER_IDS` podem executar
- Verifica√ß√£o autom√°tica de permiss√µes
- Log de todas as a√ß√µes administrativas

#### **Rate Limiting por Usu√°rio**
- Limites individuais para cada usu√°rio
- Preven√ß√£o de spam e abuso
- Detec√ß√£o de comportamento suspeito

### **Prote√ß√£o de Dados**

#### **Dados Sens√≠veis**
- Credenciais nunca s√£o expostas nos logs
- Dados de usu√°rio s√£o criptografados
- Backup autom√°tico com criptografia

#### **Auditoria**
- Log de todas as a√ß√µes importantes
- Hist√≥rico de mudan√ßas de configura√ß√£o
- Rastreamento de problemas

## üöÄ **ESCALABILIDADE**

### **Arquitetura Modular**

#### **Componentes Independentes**
- Cada sistema pode ser escalado independentemente
- Configura√ß√µes separadas para cada m√≥dulo
- F√°cil adi√ß√£o de novos recursos

#### **Banco de Dados Distribu√≠do**
- Cada funcionalidade tem seu pr√≥prio banco
- Reduz conflitos e locks
- Permite otimiza√ß√µes espec√≠ficas

### **Performance**

#### **Cache Distribu√≠do**
- Cache em mem√≥ria para m√°xima velocidade
- Persist√™ncia em disco para durabilidade
- Limpeza autom√°tica para controle de mem√≥ria

#### **Rate Limiting Inteligente**
- M√∫ltiplas estrat√©gias para diferentes cen√°rios
- Ajuste autom√°tico baseado em respostas
- Preven√ß√£o de bloqueios

## üìà **ROADMAP FUTURO**

### **Curto Prazo (1-2 meses)**
- ‚úÖ Testes de integra√ß√£o completos
- ‚úÖ Valida√ß√£o de performance em produ√ß√£o
- ‚úÖ Documenta√ß√£o de usu√°rio e administrador
- üîÑ Treinamento da equipe de suporte

### **M√©dio Prazo (3-6 meses)**
- üîÑ Machine Learning para recomenda√ß√µes personalizadas
- üîÑ API REST para integra√ß√£o com outros sistemas
- üîÑ Dashboard web para administra√ß√£o avan√ßada
- üîÑ Sistema de backup autom√°tico dos bancos de dados

### **Longo Prazo (6-12 meses)**
- üîÑ Integra√ß√£o com mais plataformas de e-commerce
- üîÑ Sistema de an√°lise preditiva de pre√ßos
- üîÑ App mobile nativo para usu√°rios
- üîÑ Integra√ß√£o com sistemas de pagamento

## üìû **SUPORTE E CONTATO**

### **Canais de Suporte**
- **Telegram**: @admin_username
- **Email**: suporte@empresa.com
- **Documenta√ß√£o**: Este arquivo + README.md

### **Recursos de Ajuda**
- **Logs do Sistema**: Para diagn√≥stico t√©cnico
- **Comandos de Teste**: Para verifica√ß√£o de funcionalidades
- **M√©tricas de Performance**: Para an√°lise de problemas
- **Documenta√ß√£o T√©cnica**: Para desenvolvedores

---

## üìù **NOTAS DE VERS√ÉO**

### **Vers√£o 2.0.0** - Sistema Completo
- ‚úÖ Todas as funcionalidades implementadas
- ‚úÖ Testes de integra√ß√£o passando
- ‚úÖ Performance validada em produ√ß√£o
- ‚úÖ Documenta√ß√£o completa

### **Vers√£o 1.0.0** - Sistema B√°sico
- ‚úÖ Bot Telegram funcional
- ‚úÖ Scrapers b√°sicos
- ‚úÖ Sistema de notifica√ß√µes

---

**√öltima Atualiza√ß√£o**: 12 de Agosto de 2025  
**Vers√£o**: 2.0.0  
**Status**: ‚úÖ PRONTO PARA PRODU√á√ÉO
